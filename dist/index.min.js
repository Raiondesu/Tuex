"use strict";function isObject(t){return!!t&&"[object Object]"===Object.prototype.toString.apply(t)}function isFunction(t){return!!t&&(t instanceof Function||"function"==typeof t)}function isValue(t){return!(!t||isFunction(t.value)||t.get||t.set)}function isGetter(t){return!!t&&t.get&&!t.set}function isSetter(t){return!!t&&!t.get&&t.set}Object.defineProperty(exports,"__esModule",{value:!0});var desc=Object.getOwnPropertyDescriptor,keysOf=Object.getOwnPropertyNames,Tuex=function(){function t(t,e){var o=this;this._eventPool={value:[],getter:[],setter:[],action:[],global:[]};this._strict=!1;this.store=null;var r=e||{strict:!1,plugins:[]},n=r.strict,i=r.plugins;this._strict=n;this.replaceStore(t);i&&i.forEach(function(t){return t.apply(o)})}t.prototype._storeEvent=function(t,e,o){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];this._eventPool[t].forEach(function(t){return t.apply(void 0,[e,o].concat(r))})};t.prototype.subscribe=function(t,e){var o=this;this._eventPool[t].push(e);return function(){o._eventPool[t]=o._eventPool[t].filter(function(t){return t!=e}).slice()}};t.prototype.replaceStore=function(t){var e;if(isFunction(t))try{e=new t}catch(o){e=t()}else e=t;this.store=this.objectToStore(e,t);this._vue&&(this._vue.prototype.$store=this.store)};t.prototype.objectToStore=function(t,e){var o=this,r={},n=[].concat(keysOf(t));isFunction(e)&&n.push.apply(n,keysOf(e.prototype));for(var i=this,s=0,c=n;s<c.length;s++){var u=c[s];!function(n){var s=function(t){return Object.defineProperty(r,n,t)},c=desc(t,n)||desc(e.prototype,n),u=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return(s=o._storeEvent).call.apply(s,[o,e,t,n].concat(r));var s};if(isFunction(t[n]))s({configurable:!1,enumerable:!1,writable:!1,value:function(){u.apply(void 0,["action"].concat([].concat(arguments)));return t[n].apply(r,arguments)}});else if(isValue(c)){var l=isObject(t[n]);l&&(t[n]=i.objectToStore(t[n],void 0));s({configurable:!1,enumerable:!0,get:function(){u("value");return t[n]},set:i._strict?function(){"production"!==process.env.NODE_ENV&&console.error("Explicit mutations of store values are prohibited!\nPlease, use setters instead or disable the [immutableState] flag!")}:function(e){u("global",e);u("value",e);t[n]=l?o.objectToStore(e,void 0):e}})}else isGetter(c)?s({configurable:!1,enumerable:!1,get:function(){u("getter");return t[n]}}):isSetter(c)?s({configurable:!1,enumerable:!1,set:function(e){u("global",e);u("setter",e);t[n]=e}}):"production"!==process.env.NODE_ENV&&console.error("Descriptor of "+n+" is wrong!")}(u)}return r};t.prototype.install=function(t){if(this._vue&&t===this._vue)"production"!==process.env.NODE_ENV&&console.error("[tuex] is already installed. Vue.use(new Tuex(...)) should be called only once.");else{this._vue=t;this._vue.prototype.$store=this.store}};return t}();exports.default=Tuex;