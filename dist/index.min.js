"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=Object.getOwnPropertyDescriptor,e=Object.getOwnPropertyNames;function o(t){return!!t&&(t instanceof Function||"function"==typeof t)}var Tuex=function(){function Tuex(t,e){var o=this;this._eventPool={value:[],getter:[],setter:[],action:[],global:[]};this._strict=!1;this.store=null;var r=e||{strict:!1,plugins:[]},n=r.strict,i=r.plugins;this._strict=n;this.replaceStore(t);i&&i.forEach(function(t){return t.apply(o)})}Tuex.prototype._storeEvent=function(t,e,o){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];this._eventPool[t].forEach(function(t){return t.apply(void 0,[e,o].concat(r))})};Tuex.prototype.subscribe=function(t,e){var o=this;this._eventPool[t].push(e);return function(){o._eventPool[t]=o._eventPool[t].filter(function(t){return t!=e}).slice()}};Tuex.prototype.replaceStore=function(t){var e;if(o(t)){try{e=new t}catch(o){e=t()}this.store=this.objectToStore(e,t)}else{e=t;this.store=this.objectToStore(e)}this._vue&&(this._vue.prototype.$store=this.store)};Tuex.prototype.objectToStore=function(r,n){var i=this,s={},c=[].concat(e(r));o(n)&&c.push.apply(c,e(n.prototype));for(var u=function(e){var c,u,a,p,f=function(t){return Object.defineProperty(s,e,t)},v=t(r,e)||t(n.prototype,e),h=function(t){for(var o,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];return(o=i._storeEvent).call.apply(o,[i,t,r,e].concat(n))};if(o(r[e]))f({configurable:!1,enumerable:!1,writable:!1,value:function(){h.apply(void 0,["action"].concat([].concat(arguments)));return r[e].apply(s,arguments)}});else if(p=v,!p||o(p.value)||p.get||p.set)u=v,u&&u.get&&!u.set?f({configurable:!1,enumerable:!1,get:function(){h("getter");return r[e]}}):(c=v,c&&!c.get&&c.set?f({configurable:!1,enumerable:!1,set:function(t){h("global",t);h("setter",t);r[e]=t}}):"production"!==process.env.NODE_ENV&&console.error("Descriptor of "+e+" is wrong!"));else{var b=!!(a=r[e])&&"[object Object]"===Object.prototype.toString.apply(a);b&&(r[e]=l.objectToStore(r[e]));f({configurable:!1,enumerable:!0,get:function(){h("value");return r[e]},set:l._strict?function(){"production"!==process.env.NODE_ENV&&console.error("Explicit mutations of store values are prohibited!\nPlease, use setters instead or disable the [strict] flag!")}:function(t){h("global",t);h("value",t);r[e]=b?i.objectToStore(t):t}})}},l=this,a=0,p=c;a<p.length;a++){u(p[a])}return s};Tuex.prototype.install=function(t){if(this._vue&&t===this._vue)"production"!==process.env.NODE_ENV&&console.error("[tuex] is already installed. Vue.use(new Tuex(...)) should be called only once.");else{this._vue=t;this._vue.prototype.$store=this.store}};return Tuex}();exports.default=Tuex;